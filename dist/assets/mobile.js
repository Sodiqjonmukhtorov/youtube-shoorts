function m(){return chrome.runtime.id?chrome.storage.sync.get(["toggleState","toggleNavState","toggleHomeFeedState","toggleHomeFeedStateLives","toggleHomeFeedStatePremieres","toggleSubscriptionFeedState","toggleSubscriptionFeedStateLives","toggleSubscriptionFeedStatePremieres","toggleTrendingFeedState","toggleSearchState","toggleRecommendedState","toggleTabState","toggleHomeTabState","toggleTurboState","toggleRegularState","toggleNotificationState"]):location.reload()}async function i(){if(!chrome.runtime.id||!location.href.startsWith("https://m.youtube.com/"))return;const e=await m();e.toggleState&&(e.toggleNavState&&g(),e.toggleHomeFeedState&&(S(),y()),e.toggleSubscriptionFeedState&&(b(),N()),e.toggleTrendingFeedState&&T(),e.toggleSearchState&&E(),e.toggleRecommendedState&&w(),e.toggleTabState&&A(),e.toggleHomeTabState&&v(),e.toggleRegularState&&q())}function g(){document.querySelectorAll(".pivot-shorts").forEach(e=>{const t=e.parentNode;t.style.display="none"})}function S(){location.href==="https://m.youtube.com/"&&document.querySelectorAll(".reel-shelf-items").forEach(e=>{const t=e.parentNode.parentNode.parentNode;t.style.display="none"})}function y(){location.href==="https://m.youtube.com/"&&document.querySelectorAll('[href^="/shorts/"]').forEach(e=>{if(e.classList.contains("ytd-notification-renderer"))return;const t=e.parentNode.parentNode.parentNode;t.style.display="none"})}function b(){location.href==="https://m.youtube.com/feed/subscriptions"&&document.querySelectorAll(".reel-shelf-items").forEach(e=>{const t=e.parentNode;t.parentNode.parentNode.style.display="none"})}function N(){location.href.includes("m.youtube.com/feed/subscriptions")&&document.querySelectorAll('[href^="/shorts/"]').forEach(e=>{if(e.classList.contains("ytd-notification-renderer"))return;const t=e.parentNode.parentNode.parentNode;t.style.display="none"})}function T(){(location.href.includes("m.youtube.com/feed/explore")||location.href.includes("m.youtube.com/gaming"))&&(document.querySelectorAll('[href^="/shorts/"]').forEach(t=>{const n=t.parentNode.parentNode.parentNode;n.style.display="none"}),document.querySelectorAll(".reel-shelf-items").forEach(t=>{const n=t.parentNode.parentNode.parentNode;n.style.display="none"}))}function E(){if(!document.querySelector("ytm-search"))return;document.querySelectorAll(".reel-shelf-items").forEach(n=>{const r=n.parentNode;r.style.display="none"}),document.querySelectorAll('[aria-label="Shorts"]').forEach(n=>{if(n.classList.contains("ytd-notification-renderer"))return;const r=n.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;r.style.display="none"})}function w(){location.href.includes("m.youtube.com/watch")&&document.querySelectorAll('[href^="/shorts/"]').forEach(e=>{if(e.classList.contains("ytd-notification-renderer"))return;const t=e.parentNode.parentNode;t.style.display="none"})}function A(){const o=document.querySelectorAll(".scbrr-tab.center");Array.from(o).filter(t=>t.innerText.toLowerCase()==="shorts").forEach(t=>{t.parentNode.removeChild(t)})}function v(){(location.href.includes("/channel/")||location.href.includes("@")||location.href.includes("/user/")||location.href.includes("/c/"))&&(document.querySelectorAll(".reel-shelf-items").forEach(t=>{const n=t.parentNode.parentNode.parentNode;n.style.display="none"}),document.querySelectorAll(".scbrr-tab.center").forEach(t=>{t.getAttribute("role")==="tab"&&t.getAttribute("aria-selected")==="true"&&t.innerText.toLowerCase()!=="shorts"&&document.querySelectorAll('[href^="/shorts/"]').forEach(r=>{if(r.classList.contains("ytd-notification-renderer"))return;const s=r.parentNode;s.style.display="none"})}))}function q(){function o(t){const n=/\/shorts\/([^/]+)/,r=t.match(n);return r?r[1]:null}const e=o(location.href);e&&(location.href=`https://m.youtube.com/watch?v=${e}`)}let l,p;async function d(o){const e=await m();if(!e.toggleState)return;const t=document.body;if(t!=null){if(o&&i(),setTimeout(()=>{i()},1500),e.toggleTurboState)p=setInterval(()=>{i()},500);else{let r=function(s,c){let u,a;return function(){const f=this,h=arguments;a?(clearTimeout(u),u=setTimeout(function(){Date.now()-a>=c&&(s.apply(f,h),a=Date.now())},c-(Date.now()-a))):(s.apply(f,h),a=Date.now())}};var n=r;l=new MutationObserver(r(async function(s,c){setTimeout(()=>{i()},1500)},3e3)),l.observe(t,{childList:!0,subtree:!0})}return}else setTimeout(function(){d()},1e3)}window.addEventListener("load",async function(){d()});chrome.runtime.onMessage.addListener(async function(o,e,t){o.checkStates&&(l&&l.disconnect(),clearInterval(p),d(!0))});
